CREATE OR REPLACE VIEW -- ok
q_cb_work_up_with_curr_coeff AS
SELECT q_cb_analysis_activem_with_prices.rep_month, q_cb_analysis_activem_with_prices.pc, q_cb_analysis_activem_with_prices.l_1, q_cb_analysis_activem_with_prices.l_2, q_cb_analysis_activem_with_prices.l_3, q_cb_analysis_activem_with_prices.l_4, q_cb_analysis_activem_with_prices.l_5, q_cb_analysis_activem_with_prices.l_6, q_cb_analysis_activem_with_prices.exp_cb_mon AS month, sum(an_rs_quantity*up_cost*k_usd*k_eur) AS up, q_cb_curr_escalation_rates.rs_currency
FROM q_cb_analysis_activem_with_prices LEFT JOIN q_cb_curr_escalation_rates ON (q_cb_analysis_activem_with_prices.rep_month = q_cb_curr_escalation_rates.rep_month) AND (q_cb_analysis_activem_with_prices.pc = q_cb_curr_escalation_rates.pc) AND (q_cb_analysis_activem_with_prices.l_1 = q_cb_curr_escalation_rates.l_1) AND (q_cb_analysis_activem_with_prices.l_2 = q_cb_curr_escalation_rates.l_2) AND (q_cb_analysis_activem_with_prices.l_3 = q_cb_curr_escalation_rates.l_3) AND (q_cb_analysis_activem_with_prices.l_4 = q_cb_curr_escalation_rates.l_4) AND (q_cb_analysis_activem_with_prices.l_5 = q_cb_curr_escalation_rates.l_5) AND (q_cb_analysis_activem_with_prices.l_6 = q_cb_curr_escalation_rates.l_6) AND (q_cb_analysis_activem_with_prices.rs_l1 = q_cb_curr_escalation_rates.rs_l1) AND (q_cb_analysis_activem_with_prices.rs_l2 = q_cb_curr_escalation_rates.rs_l2) AND (q_cb_analysis_activem_with_prices.rs_l3 = q_cb_curr_escalation_rates.rs_l3) AND (q_cb_analysis_activem_with_prices.rs_l4 = q_cb_curr_escalation_rates.rs_l4) AND (q_cb_analysis_activem_with_prices.currency = q_cb_curr_escalation_rates.rs_currency) AND (q_cb_analysis_activem_with_prices.exp_cb_mon = q_cb_curr_escalation_rates.month)
GROUP BY q_cb_analysis_activem_with_prices.rep_month, q_cb_analysis_activem_with_prices.pc, q_cb_analysis_activem_with_prices.l_1, q_cb_analysis_activem_with_prices.l_2, q_cb_analysis_activem_with_prices.l_3, q_cb_analysis_activem_with_prices.l_4, q_cb_analysis_activem_with_prices.l_5, q_cb_analysis_activem_with_prices.l_6, q_cb_analysis_activem_with_prices.exp_cb_mon, q_cb_curr_escalation_rates.rs_currency
ORDER BY q_cb_analysis_activem_with_prices.rep_month, q_cb_analysis_activem_with_prices.pc, q_cb_analysis_activem_with_prices.l_1, q_cb_analysis_activem_with_prices.l_2, q_cb_analysis_activem_with_prices.l_3, q_cb_analysis_activem_with_prices.l_4, q_cb_analysis_activem_with_prices.l_5, q_cb_analysis_activem_with_prices.l_6, q_cb_analysis_activem_with_prices.exp_cb_mon, sum(an_rs_quantity*up_cost*k_usd*k_eur);
